<!DOCTYPE HTML>
<html>
<head>
<title>Vapomatic</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<style type="text/css">

div#graphs {
	display: flex;
}

div#graphs > div {
	width: 500px;
	height: 500px;
}

</style>

</head>
<body>

<div id="graphs">

<div>
<img class="graph" data-file="/graph/temp.svg" src="/graph/temp.svg" alt="Temperaturas" width="500" height="500" />
</div>

<div>
<img class="graph" data-file="/graph/gist.svg" src="/graph/gist.svg" alt="Retas" width="500" height="500" />
</div>

</div> <!-- #graphs -->

<script>

function update_graphs(){    

	document.querySelectorAll("img.graph").forEach(function(graph){
		var file = graph.getAttribute("data-file");
		var timestamp = new Date().getTime();  
		var src = file + "?t=" + timestamp;    
		graph.src = src;    
	});

}

setInterval(update_graphs, 250);

// Conexão WebSocket
ws = new WebSocket('ws://127.0.0.1:8888');

ws.onopen = function(event){
  console.log("Conexão aberta");
}

ws.onmessage = function(event){
  var data = JSON.parse(event.data);
  console.log(data);
}

</script>

</body>
</html>
